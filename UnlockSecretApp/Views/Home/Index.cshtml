<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Кодовое окно</title>
</head>
<body>

<div id="container">
    <h1>Введите дату</h1>
    <div>
        <input type="text" maxlength="2" id="c1">
        <input type="text" maxlength="2" id="c2">
        <input type="text" maxlength="2" id="c3">
        <input type="text" maxlength="2" id="c4">
    </div>
    <div style="margin-top: 20px;">
        <div id="kitten" style="width: 100px; height: 50px; background: #ccc; position: relative; cursor: pointer;">
            <div id="kittenFill" style="width: 0%; height: 100%; background: #4fc3f7; position: absolute; top: 0; left: 0;"></div>
            🐳
        </div>
    </div>
    <div id="message"></div>
</div>

<div id="overlay" style="display: none; position: fixed; inset:0; background: rgba(0,0,0,0.8); color:#fff; padding: 2rem;">
    <div id="intro" style="opacity: 0; font-size: 1.5rem;"></div>
    <div id="details" style="margin-top: 2rem; font-size: 1.2rem;"></div>
</div>

<script>
const correctCode = ["12","25","07","99"];
const inputs = [c1, c2, c3, c4];
const container = document.getElementById('container');
const overlay = document.getElementById('overlay');
const intro = document.getElementById('intro');
const details = document.getElementById('details');

inputs[0].focus();

// Переход по инпутам
inputs.forEach((input, i) => {
  input.addEventListener('input', () => {
    if (input.value.length === 2 && i < inputs.length-1) inputs[i+1].focus();
  });
});

// Проверка кода
function isCodeCorrect() {
  return inputs.map(i => i.value).join('') === correctCode.join('');
}

// Эффект печати
function typeWriter(el, text, delay = 50, cb=null) {
  let i=0;
  el.style.opacity = 1;
  el.textContent = "";
  (function t(){
    if(i<text.length){el.textContent += text[i]; i++; setTimeout(t, delay);}
    else if(cb) cb();
  })();
}

// Показ overlay
function showOverlay(){
  container.style.display = 'none';
  overlay.style.display = 'block';
  typeWriter(intro, "Это не совсем обычные числа и вот почему...",50,()=>{
    typeWriter(details,
      "14 — день, когда мы познакомились 💫\n"+
      "25 — твой любимый номер 💖\n"+
      "07 — месяц нашего первого свидания 🌸\n"+
      "99 — просто навсегда ♾️",45);
  });
}

// Китёнок
const kitten = document.getElementById('kitten');
const kittenFill = document.getElementById('kittenFill');
let holdInterval, fill=0;

function startHold(e){
  e.preventDefault();
  fill = 0;
  kittenFill.style.width = '0%';
  holdInterval = setInterval(()=>{
    fill += 2;
    if(fill>100) fill=100;
    kittenFill.style.width = fill+'%';
    if(fill>=100){
      clearInterval(holdInterval);
      if(isCodeCorrect()){
        showOverlay();
      } else {
        kittenFill.style.transition='width 0.3s';
        kittenFill.style.width='0%';
        setTimeout(()=>{kittenFill.style.transition='';},300);
      }
    }
  },50);
}

function cancelHold(){
  clearInterval(holdInterval);
  kittenFill.style.width='0%';
}

kitten.addEventListener('mousedown', startHold);
kitten.addEventListener('touchstart', startHold);
document.addEventListener('mouseup', cancelHold);
document.addEventListener('touchend', cancelHold);
</script>

</body>
</html>
